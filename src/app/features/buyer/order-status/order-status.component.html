<div *ngIf="isLoading==true">
    <div class="load-wrapp">
        <div class="load-4">
            <p>Loading...</p>
            <div class="ring-1"></div>
        </div>
    </div>
</div>

<div *ngIf="isEmpty==true">
  Saat ini belum ada pesanan.
</div>

<div *ngFor="let item of list">
  <div  class="os-head">
      <div class="row row-atur">
        <div class="col-3">
            <div class="text-order">{{item.createdTime}}</div>
        </div>
        <div class="col-9">
            <div class="text-rek" (click)="showDialogRek = !showDialogRek">Lihat Nomor Rekening Belisada <span class="text-yellow"><fa-icon [icon]="['fas', 'credit-card']"></fa-icon></span></div>
            <div class="text-confirm" (click)="confirm(item.paymentNumber)">Konfirmasi Pembayaran <span class="text-yellow"><fa-icon [icon]="['fa', 'bell']"></fa-icon></span></div>
            <div class="text-more" (click)="openOS(openDetail, item.transactionId)">See More <span class="text-yellow"><fa-icon [icon]="['fa', 'search']"></fa-icon></span></div>
        </div>
      </div>
      <div class="row row-atur">
        <div class="col-4">
            <div class="text-payid">Payment ID: {{item.paymentNumber}} </div>
        </div>
        <div class="col-6">

            <div class="text-payinfo">Payment: ({{item.paymentMethod}})
              <!-- <span class="btn-konfirm" (click)="showDialog = !showDialog" (click)="takeId(item.transactionId, item.imageUrl)">Unggah Bukti Transfer</span> -->
            </div>
        </div>
        <div class="col-2">
          <div class="text-progress"> <span id="text-tunggu">{{item.status}}</span></div>
        </div>
      </div>
  </div>
  <div *ngIf="openDetail==true && transactionId==item.transactionId" class="os-body">

    <table border="0" width="100%" *ngFor="let itemCart of item.transaction">
      <tr *ngFor="let itemList of itemCart.cart">
        <td valign="top" width="20%">
          <span class="order-id">ORDER ID: {{itemList.orderNumber}}</span>
          <table border="0" width="100%">
            <tr *ngFor="let itemListProduct of itemList.cartItems">
              <td valign="top" width="40%">
                  <div class="img-item"><img src="{{itemListProduct.imageUrl}}" border="0"></div>
              </td>
              <td valign="top" width="60%">
                  <div class="item-colom">{{itemListProduct.name}} x{{ itemListProduct.quantity }} <br>Produk ID: {{itemListProduct.productId}}</div>
                  <div class="item-colom">Rp.{{itemListProduct.subtotal | number}}</div>
              </td>
            </tr>
          </table>
        </td>
        <td valign="top" width="35%">
          <div class="item-colom-border">
            <div class="row">
              <div class="col-6">
                Nama Penerima: <br><label>{{itemList.namaPenerima}}</label>
              </div>
              <div class="col-6">
                No Handphone: <br><label>{{itemList.phonePenerima}}</label>
              </div>
            </div>

            Alamat: {{itemList.alamatSebagai}}<br><label>{{ itemList.alamatPenerima }}</label>

          </div>
        </td>
        <td valign="top" width="22%">
          <div class="item-colom">
            <div class="row">
              <div class="col-12">
                No Resi: <label>{{itemList.noResi}} ({{itemList.courierName}} {{itemList.courierService}})</label>
              </div>
              <div class="col-12">
                Status: <label>{{itemList.statusOrder}}</label>
              </div>
              <div class="col-12">
                Total Berat: <label>{{itemList.totalWeight}}kg</label>
              </div>
              <div class="col-12">
                Biaya Pengiriman: <label>Rp.{{itemList.courierPrice | number}}</label>
              </div>
            </div>
          </div>
        </td>
        <td width="33%">
          <span *ngIf="itemList.statusOrderCode === '157'" (click)="receiptConfirmation(itemList.orderNumber)" class="btn-konfirm">Konfirmasi Barang</span> <a class="btn-invoice" target="_blank" [routerLink]="['/invoice/' + itemList.orderNumber]"><u>Lihat Invoice</u></a>
        </td>
      </tr>
    </table>
  </div>
</div>
<div class="paging" *ngIf="proddetail.totalElements != 0">
	<ul>
		<li>
			<a (click)="setPage(1)" [ngClass]="{disabled:currentPage == 1}">First</a>
		</li>
		<li>
			<a (click)="setPage(currentPage, -1)" [ngClass]="{disabled:(currentPage-1) < 1}">Previous</a>
		</li>
		<li *ngFor="let p of pages">
			<a (click)="setPage(p)" [ngClass]="currentPage == p?'current-page':''">{{p}}</a>
		</li>
		<li>
			<a (click)="setPage(currentPage, +1)" [ngClass]="{disabled:currentPage == lastPage}">Next</a>
		</li>
		<li>
			<a (click)="setPage(lastPage)" [ngClass]="{disabled:currentPage == lastPage}">Last</a>
		</li>
	</ul>
</div>


<app-models [(visible)]="showDialog" class="frameDialog">
  <div class="modal-body">

    <div *ngIf="isForm==true">

      <div class="title-modal">Upload Bukti Transfer Anda</div>

      <div class="image">
        <img src="{{imgBuktiTransfer}}" alt="Profile Picture" class="img-avatar" (load)="setCanvas($event,'imgBuktiTransfer')" #avaImg />
      </div>

      <div class="upload-btn-wrapper" *ngIf="isPilih == true">
          <div class="btn-konfirm">Pilih Bukti Transfer</div>
          <input type="file" name="myfile" (change)="setUrl($event, avaImg)"/>
      </div>
      <div class="btn-upload" *ngIf="isSent == true" (click)="uploadBuktiTransfer()">Klik disini untuk unggah bukti transfer</div>

    </div>
    <div *ngIf="regSuccess==true" class="isSuccess">
        <div class="title-modal">Upload Bukti Transfer Berhasil</div>
        <div class="text-success">berhasil.</div>
    </div>
  </div>
</app-models>

<app-models [(visible)]="showDialogRek" class="frameDialog">
  <div class="modal-body">

    <div class='list-metode'>
      <div class="row">
          <div class="col-3" *ngFor="let item of listPayment">
              <div class="img-pay"><img src="{{ item.imageUrl }}" class="img-icon"></div>
              {{ item.accountNumber }}<br>A.N.<br>{{ item.accountName }}
          </div>
      </div>
  </div>

  </div>
</app-models>
